<div class="lobby-container">
  <!-- Decorative background elements -->
  <div class="bg-decoration"></div>
  <div class="bg-decoration-2"></div>
  
  <div class="lobby-card">
    <!-- Header with animated icon -->
    <div class="lobby-header">
      <div class="welcome-icon">
        <img src="assets/img/logo.png" alt="Bingo Logo" class="logo-image">
      </div>
      <!-- Título dinámico según sesión -->
      <h2 class="lobby-title" *ngIf="!isAuthenticated; else saludoAutenticado">¡Únete a la Diversión!</h2>
      <ng-template #saludoAutenticado>
        <h2 class="lobby-title">¡Bienvenido, {{ currentUserName }}!</h2>
      </ng-template>
      <p class="lobby-subtitle">
        <!-- Subtítulo amigable según estado -->
        {{ isAuthenticated ? 'Estás autenticado. Crea una sala o únete a una partida.' : 'Crea una nueva sala o únete a una partida existente' }}
      </p>
    </div>

    <!-- Player name input -->
    <div class="input-container">
      <mat-form-field appearance="outline" class="custom-input">
        <mat-label>Tu Nombre de Jugador</mat-label>
        <!-- Si hay sesión, el nombre se completa y se bloquea para mantener consistencia -->
        <input matInput [(ngModel)]="nombreJugador" name="nombreJugador" required [disabled]="isAuthenticated" placeholder="Ej: ProfeSebas ó SuperJugador">
        <mat-icon matSuffix class="input-icon">badge</mat-icon>
      </mat-form-field>
      <!-- Mensaje de ayuda -->
      <small *ngIf="isAuthenticated" class="text-gray-500">Usaremos tu nombre de usuario para la sala.</small>
    </div>

    <!-- Tabs with modern styling -->
    <mat-tab-group animationDuration="500ms" mat-stretch-tabs="false" mat-align-tabs="center" class="custom-tabs">
      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon class="tab-icon">add_circle_outline</mat-icon>
          Crear Sala
        </ng-template>
        <div class="tab-content">
          <div class="input-container">
            <mat-form-field appearance="outline" class="custom-input">
              <mat-label>Nombre de la Sala</mat-label>
              <input matInput [(ngModel)]="nombreSala" name="nombreSala" required placeholder="Ej: ALED3-Comisión-1">
              <mat-icon matSuffix class="input-icon">groups</mat-icon>
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="onCrearSala()" class="primary-btn create-btn">
            <mat-icon class="btn-icon">add</mat-icon>
            <span>Crear Nueva Sala</span>
            <div class="btn-ripple"></div>
          </button>
        </div>
      </mat-tab>
      <mat-tab>
        <ng-template mat-tab-label>
          <mat-icon class="tab-icon">input</mat-icon>
          Unirse a Sala
        </ng-template>
        <div class="tab-content">
          <div class="input-container">
            <mat-form-field appearance="outline" class="custom-input">
              <mat-label>ID de la Sala</mat-label>
              <input matInput [(ngModel)]="salaIdUnirse" name="salaIdUnirse" required placeholder="Ej: 8F2C-9A">
              <mat-icon matSuffix class="input-icon">vpn_key</mat-icon>
            </mat-form-field>
          </div>
          <button mat-raised-button (click)="unirseASala()" class="primary-btn join-btn">
            <mat-icon class="btn-icon">arrow_forward</mat-icon>
            <span>Unirse a la Partida</span>
            <div class="btn-ripple"></div>
          </button>
        </div>
      </mat-tab>
    </mat-tab-group>
    
    <!-- Version display -->
    <div class="version-display" (click)="showChangelog()">
      <span class="version-text">{{ versionService.getFormattedVersion() }}</span>
    </div>
  </div>

  <!-- Chat Flotante Global -->
  <app-chat-flotante 
    *ngIf="nombreJugador"
    salaId="lobby-global"
    [jugadorActual]="{id: 'lobby-user', nombre: nombreJugador, puntuacion: 0, lineasCompletadas: 0}"
    [posicion]="'bottom-right'">
  </app-chat-flotante>
</div>
